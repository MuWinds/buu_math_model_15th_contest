# 北京联合大学数学建模校赛源码和论文

## 北京联合大学数学建模校赛 A 题 题面

随着 5G、物联网和生成式 AI 技术快速发展，全球算力需求呈现爆发式增长，高密度算力集群的全年运行导致能耗和碳排放量激增。作为人工智能时代的核心基础设施，数据中心面临严峻的能源挑战。在此背景下，应用绿色能源（如太阳能、风能、水能等）提供的电力（简称绿色电力），已成为解决数据中心能源问题的重要途径。

如何平衡数据中心电力供应与算力需求的压力，成为亟待解决的问题。特别是，在全球能源转型的过程中，如何有效地将绿色电力与传统电力结合使用，在电力供应不稳定的情况下，使计算任务的分配和调度既能够满足服务质量要求，又能最大化利用绿色电力，达到降低电力成本和碳排放的目标。

假设某数据中心电力供应存在传统电力和绿色电力两种类型。电价随着供需波动而变化，且绿色电力供应有上限（见附件 1）。在电力供应中，优先考虑使用绿色电力，若绿色电力不足，则需要使用传统电力。该数据中心有多个计算任务，每个任务的优先级不同（分为高紧急、中紧急和低紧急的任务），不同时间段内有不同的算力需求（见附件 2）。任务调度过程中，需要考虑不同任务的优先级，确保重要任务（高紧急任务）不会受到影响，而不重要的任务（如中紧急和低紧急任务）则可以根据电力供应情况适当延迟，要求每个任务从发布到完成不能超过 24 小时。每个服务器群组的计算能力有限，且每个群组的功耗在运行时是线性的，计算任务的进度与分配的电力和算力直接相关。

请建立数学模型，解决以下问题：

**问题 1**：利用所给的数据，分析数据中心一天内每小时电力需求与电力（包括绿色电力和传统电力）供应的关系，给出基础调度方案，解决电力供需平衡问题。

**问题 2**：根据经验，高紧急任务在其所属时间段内优先分配绿色电力，若绿色电力不足，按传统电价从低到高分配剩余电力需求；对中紧急任务，在绿色电力充足且电价低的时间段（如白天）优先调度；剩余任务延迟至电价低谷时段（如凌晨），达到优先级任务调度与绿色能源电力最大化的目标。按照上面描述的电力调度策略计算优化后的传统电力使用量及成本，并与问题 1 的结果进行对比。

**问题 3**：以降低电力成本及碳排放为目标，建立数学模型，满足电力调度约束，为该数据中心电力调度提供更优的策略。

**问题 4**：基于问题 3 建立的数学模型，对该模型进行鲁棒性分析，为数据中心电力调度提供策略建议。

## 论文：数据中心电力-算力协同调度模型

### 摘要

针对数据中心高能耗与碳排放问题，本文提出一种电力-算力协同调度模型，旨在最大化绿色电力利用率并降低电力成本。首先，构建基础调度模型（问题 1），通过均分时段任务并优先使用绿色电力，得到总成本。其次，引入任务优先级机制（问题 2），高紧急任务优先分配绿色电力，中低优先级任务在电价低谷时段调度，优化后绿色电力利用率显著提升，成本降低。进一步，建立线性规划模型（问题 3），以最小化成本为目标，结合绿色电力奖励机制，实现线性规划模型较基础模型降低 46.1%。最后，通过鲁棒性分析验证模型稳定性：在绿色电力供应 ±20%波动和任务量变化时，模型 3 成本波动最小，显著优于其他模型。结果表明，线性规划模型兼顾成本、环保与稳定性，建议数据中心采用动态电价响应策略，设计冗余供电系统，并利用敏感性分析优化实时调度。该研究为数据中心低碳化运营提供了理论依据与实用工具。

### 关键词

绿色能源利用率 线性规划 动态电价响应策略 鲁棒性分析 混合能源成本优化

### 一、问题重述

随着 5G、物联网和生成式 AI 技术快速发展，全球算力需求呈现爆发式增长，高密度算力集群的全年运行导致能耗和碳排放量激增，数据中心面临严峻的能源挑战。在此背景下，应用绿色能源平衡数据中心电力供应与算力需求的压力，特别是，如何有效地将绿色电力与传统电力结合使用，在电力供应不稳定的情况下，使计算任务的分配和调度既能够满足服务质量要求，又能最大化利用绿色电力，达到降低电力成本和碳排放的目标，已成为解决数据中心能源问题的重要途径。

假设某数据中心电力供应存在传统电力和绿色电力两种类型。电价随着供需波动而在每个小时变化，根据附件 1 数据可知每个小时的绿色电力供应有上限。在电力供应中，优先考虑使用绿色电力，若绿色电力不足，则需要使用传统电力。

该数据中心有多个计算任务，优先级分为高紧急、中紧急和低紧急的任务，根据附件 2 数据可知不同时间段内有不同的算力需求。任务调度过程中，需要考虑不同任务的优先级，确保高紧急任务不会受到影响，而中紧急和低紧急任务则可以根据电力供应情况适当延迟，要求每个任务从发布到完成不能超过 24 小时。每个服务器群组的计算能力有限，且每个群组的功耗在运行时是线性的，计算任务的进度与分配的电力和算力直接相关。

我们需要设计一个模型，在保证各个优先级的任务按照题目要求完成的情况下，能够最大化利用绿色电力并尽可能降低电力成本，最后给出优化成本后的模型，并且与没有优化的模型进行鲁棒性分析，给出数据中心的电力调度的建议。

### 二、问题分析

问题 1 要求给出基础调度方案，优先解决的是电力供需平衡的关系，所以我们优先保证任务完成，将所有任务的执行视为同一优先级，将每个时段的任务平均分到时段内的每个小时里，将每个小时内平均分配的任务与其能耗相乘，将每个小时的总能耗与绿色电力的供应量去对比，如果总能耗大于绿色电力的总能耗，那么就是将绿色电力的供应量乘以绿色电力的价格，超出绿色电力的部分则是乘以传统电力的价格，否则就是直接将总能耗乘以绿色电力的价格，将上面 24 小时的电力成本求总和就是该方案的电力成本。

问题 2 则是在问题 1 的基础上考虑到了任务紧急性，按照经验主义的方案将不同任务的紧急性进行调度，将高紧急任务在其所属时间段内优先分配绿色电力，若绿色电力不足，按传统电价从低到高分配剩余电力需求；对中紧急任务，在绿色电力充足且电价低的时间段优先调度；剩余任务延迟至电价低谷时段。

问题 3 则是在问题 2 的基础上我们意识到可以采用线性优化的模型去实现更好的调度，从而实现更低的成本和更好的绿色能源利用率。

问题 4 则是鲁棒性的分析，通过参考文献[1]“仿真验证了高压直流输电系统灵活的调节作用有利于系统更好地应对风电的波动，维持系统的功率平衡”的描述我们认识到鲁棒性其实是稳定性的一种概念，我们将前面三个问题的模型在不同的数据下进行实验，确定我们所建立的模型的稳定性。

### 三、模型假设与符号说明

- $H_{T}$：在 T 时间段内的高紧急任务的总任务数
- $M_{T}$：在 T 时间段内的中紧急任务的总任务数
- $L_{T}$：在 T 时间段内的低紧急任务的总任务数
- $E_{h}$：每个小时所需要的电力，单位是千瓦时
- $Trad_{h}$：每小时分配的传统能源，单位是千瓦时
- $G_{h}$：每个小时分配的绿色电力，单位是千瓦时
- $S_{h}$：每小时绿色电力的供应量，单位是千瓦时
- $U_{h}$：绿色电力的使用率
- $p_{h}^{\mathrm{ne}}$：在 h 小时绿色电力对应的单价，单位：元
- $p_{h}^{\mathrm{trad}}$：在 h 小时传统电力对应的单价，单位：元
- $C_{h}$：每小时的电力成本，单位：元
- $C_{\mathrm{Total}}$：单日总共的电力成本，单位：元

### 四、模型建立和求解

#### 问题 1

问题 1 要求给出基础调度方案，优先解决的是电力供需平衡的关系，所以我们优先保证任务能全部完成，这里将所有任务的执行视为同一优先级，将每个时段的任务平均分到时段内的每个小时里，将每个小时内平均分配的任务与其能耗相乘，将每个小时的总能耗与绿色电力的供应量去对比，如果总能耗大于绿色电力的总能耗，那么就是将绿色电力的供应量乘以绿色电力的价格，超出绿色电力的部分则是乘以传统电力的价格，否则就是直接将总能耗乘以绿色电力的价格，将上面 24 小时的电力成本求总和就是该方案的电力成本。

我们先要计算出每个小时的任务数，这里对每个小时所包含的任务数采取对该时间段内的任务数进行平均的方案，这里的 为每个时间段内包含的小时数。

$$H_h^{} = \sum\limits_{Th}^{} {{{{H_T}} \over n}}，M_h^{} = \sum\limits_{Th}^{} {{{{M_T}} \over n}}，L_h^{} = \sum\limits_{Th}^{} {{{{L_T}} \over n}} $$

再去计算电力需求，根据题目要求，高、中、低优先级任务的单件耗电量分别为 80、50、30 千瓦时：

$$E_h^{} = 80H_h^{} + 50M_h^{} + 30L_h^{}$$

计算绿色电力的使用率，方便后面的题目使用和对比：

$$
U_{h}=\left\lbrace\begin{array}{cc}
\frac{\min \left(S_{h}, E_{h}\right)}{E_{h}} \times 100\% & E_{h}>0 \\
0 & E_{h} \leq 0
\end{array}\right.
$$

最后计算出每小时的用电成本并且求出总和：

$$
C_{h}=\left\lbrace\begin{array}{cl}
E_{h} \cdot p_{h}^{n e} & E_{h} \leq S_{h} \\
S_{h} \cdot p_{h}^{n e}+\left(E_{h} \cdot S_{h}\right) \cdot p_{h}^{\text {trad }} & E_{h}>S_{h}
\end{array}\right.
$$

$${C_{Total}} = \sum\limits_{h = 0}^{23} {{C_h}} $$
将上面的模型转换成 python 代码（见附件 problem1.py），计算出对应总成本、绿色电力利用率和传统电力的使用量：
![image](/img/img2.png)

![image](/img/img1.png)

![image](/img/img3.png)

#### 问题 2

按照题目要求，要在问题 1 所建立的模型基础上按照题目所给的经验，即高紧急任务在其所属时间段内优先分配绿色电力，若绿色电力不足，按传统电价从低到高分配剩余电力需求；对中紧急任务，在绿色电力充足且电价低的时间段（如白天）优先调度；剩余任务延迟至电价低谷时段（如凌晨），达到优先级任务调度与绿色能源电力最大化的目标去进行优化。

我们先从简单的高优先级任务调度开始讨论。高优先级任务的每小时的电力需求为：
$${E_{high,h}} = {H_T} \times 80$$
高优先级任务分配应尽可能分配绿色电力，并在此基础上分配传统电力：
$${G_{high,h}} = \min ({E_{high,h}},{S_h})，Tra{d_{high,h}} = {E_{high,h}} - {G_{high,h}}$$

这里需要考虑优先级的问题了，我们要找到中优先级任务的时间窗口，根据其时间窗口确定任务的分配，令中优先级的时间窗口符号为 $ TM_i $，任务发布时间为 $ rel_i $：

$$ TM_{i}=\left\{(rel_i+t)\bmod 24\ \middle|\ t\in[0,23]\cap \mathbb{N}\right\} $$

最后，分配策略就是利用极值点，找出任务合适的分配时间，令分配时间的极值点符号为 $ h^{*} $，并且按照电价升序，剩余量降序去排列：

$$ h^{*}=\underset{h\in TM_{i}}{\arg\min}\left[p*{h}^{ne}-\left(S*{h}-G_{high,h}\right)\right] $$

如果剩余的绿色能源大于该任务所需要的能源，即 $ S*{h}-G*{high,h}\geq E\_{mid,i} $，就将该任务用绿色能源；否则用传统能源价格最低的时间段：

$$ G_{mid,h}=G_{mid,h}+E_{mid,i} \quad \left(S*{h}-G*{high,h}\geq E*{mid,i}\right) $$
$$ \text{Trad}_{mid,h^{\prime}}=\text{Trad}_{mid,h^{\prime}}+E_{mid,i} \quad \left(S_{h}-G_{high,h}<E_{mid,i}\right) $$

低优先级的能源与中优先级的分配策略相同，但分配要在中优先级任务之后，令低优先级任务为任务 j，任务 j 的电量需求：

$$ E_{low,j}=L_{h}\times 30 $$
将上面优化过的模型转换成python代码（见附件 problem2.py），计算出对应总成本、绿色电力利用率和传统电力的使用量：
![image](img/img4.png)
![image](img/img5.png)
![image](img/img6.png)
可以看到，优化过后的模型，绿色能源利用率远高于问题1的基础模型，传统电力的使用也 少于问题1的基础模型，所耗费的电力成本也有所降低。
#### 问题3
经过上面的基础模型设计和简单优化，虽然能在保证任务能按照要求完成的同时可以降低电力成本提高绿色能源利用率，但是我们发觉模型仍然存在可以优化成本的空间，面对这种合理利用有限资源做出最优决策的问题，尝试采用线性规划的模型。

对于题目要求尽可能利用新能源的要求，我们对线性规划的目标函数设置了奖励机制，一个是使用绿色电力要进行奖励，一个是绿色能源供应量进行奖励，鼓励充分利用新能源高供应的时间段。

那么我们的目标函数就应当包含：
1.	传统电力和绿色电力的电力成本
2.	绿色电力的使用奖励（鼓励使用绿色电力）
3.	绿色电力的供应量奖励（鼓励利用绿色电力的高供应时间段）

并且要确定约束条件，首先必须要优先满足每个小时高优先级任务的电量供应：
$${E_{high,h}} = {G_{high,h}} + Tra{d_{high,h}}$$
对于中优先级任务和低优先级任务而言，每个子任务都必须要在一个时间窗口内完成，我们将每个任务是否放入时间窗口的符号命名为$ y $，放入为1，不放入为0:
$$\sum\limits_{h \in mid}^{} {{y_h}} ,\sum\limits_{h \in low}^{} {{y_h}} $$
对应的，我们的绿色电力与传统电力与任务量相关联：
$${G_h} + Tra{d_h} = {M_h} \cdot {y_h},{G_h} + Tra{d_h} = {L_h} \cdot {y_h}$$
同样的，新能源供应是要有限制的，每小时的总绿色能源使用量不超过供应量：
$${G_{h,high}} + {G_{h,mid}} + {G_{h,low}} \le {S_h}$$
最后我们的目标函数为：
$$
\begin{aligned}
C_{\text{total}} = & \text{ Minimize } \sum_{h=0}^{23}\left[\left(p_{h}^{ne}-\beta\right) \cdot E_{h}^{ne} + p_{h}^{trad} \cdot E_{h}^{trad}\right] \\
& + \sum_{i \in mid} \sum_{h \in H_{i}}\left[\left(p_{h}^{ne}-\beta\right) \cdot E_{i,h}^{ne} + p_{h}^{trad} \cdot E_{i,h}^{trad} - \gamma \cdot S_{h} \cdot y_{i,h}\right] \\
& + \sum_{j \in low} \sum_{h \in H_{j}}\left[\left(p_{h}^{ne}-\beta\right) \cdot E_{j,h}^{ne} + p_{h}^{trad} \cdot E_{j,h}^{trad} - \gamma \cdot S_{h} \cdot y_{j,h}\right]
\end{aligned}
$$

![image](img/img7.png)
![image](img/img8.png)
![image](img/img9.png)
#### 问题4
题目要求我们对三个模型进行鲁棒性分析，通过参考文献[1]“仿真验证了高压直流输电系统灵活的调节作用有利于系统更好地应对风电的波动，维持系统的功率平衡”的描述我们认识到鲁棒性其实是稳定性的一种概念，我们将前面三个问题的模型在不同的数据下进行实验，确定我们所建立的模型的稳定性。
	
我们按照以下原则以原本的题目附件数据为样本，利用Python（见附件problem4_gen.py）随机生成五份新的数据，分别放在三个模型下观察其平均利用率和电力成本，得到了两张图表：
1.	绿色电力供应按照±20%的随机波动并按小时进行调整
2.	任务需求以高优先级任务量±15%变化，整体按比例缩放
3.	传统电价按±20%波动做全局调整
![image](img/img10.png)
![image](img/img11.png)

三个模型绿色能源平均使用率表

| 测试1 | 测试2 | 测试3 | 测试4 | 测试5 |
|---|---|---|---|---|---|
| 模型1 | 57.05% | 60.00% | 49.61% | 57.92% | 61.03% |
| 模型2 | 68.91% | 69.54% | 65.28% | 69.34% | 70.39% |
| 模型3 | 68.73% | 67.32% | 63.71% | 68.01% | 69.65% |

三个模型电力成本表

| 测试1 | 测试2 | 测试3 | 测试4 | 测试5 |
|---|---|---|---|---|---|
| 模型1 | 28646.28 | 27804.27 | 37510.38 | 30975.85 | 28879.02 |
| 模型2 | 23614.69 | 23617.15 | 29624.05 | 24781.35 | 23205.82 |
| 模型3 | 17896.97 | 17690.37 | 23974.25 | 19223.22 | 17932.10 |

对两张图表进行鲁棒性分析，可得出：

1. 成本波动性有所降低：模型3的电力成本标准差为 2,596.3，模型1的标准差为 4,134.4，模型2的标准差为 2,632.2模型3的成本波动范围最小，表明其在不同场景下的成本表现更稳定。这种稳定性源自线性规划对约束条件的系统性优化，能够有效平衡资源分配和不确定性。
2. 绿色能源使用率稳健性更高：模型3的绿色能源使用率标准差为 1.8%，模型1的标准差为 4.3%，模型2的标准差为 1.9%，尽管模型2的绿色能源使用率略高，但模型3的波动性更低。线性规划通过精确的约束条件（如最低绿色能源比例）避免了极端值，从而在保证可持续性的同时降低了风险。
3. 多目标协同优化的鲁棒性：模型3的鲁棒性优势体现在：在保持绿色能源使用率接近模型2的前提下，模型3的成本比模型2低 22.8%。线性规划通过敏感性分析量化了约束条件变化对目标的影响，从而在面对输入数据波动时能快速调整策略,最后模型3通过明确的数学优化目标（如最小化成本）和约束条件（如绿色能源比例、资源限制），避免了启发式模型即模型2可能存在的局部最优或过拟合问题。

根据上述的鲁棒性分析，能给出下面几条建议：

1. 以线性规划为基础，构建“成本-可持续性-可靠性”协同优化的电力调度模型，优先级为：
可靠性 > 可持续性 > 成本。

2. 利用线性规划的敏感性分析结果，实时调整电力来源比例，应对电价波动和可再生能源间歇性。在低谷时段（如夜间）：优先使用电网低价绿电（如风电），储能系统充电，而在高峰时段（如白天）：切换至自建光伏+储能供电，避免高价电网电费。

3. 针对数据中心对极端事件的敏感性，设计抗风险调度方案，预设“极端天气”“电网故障”“算力突增”三类场景，分别优化调度策略，例如在台风预警期间，提前将储能充至90%，并启动备用柴油发电机待机，并且做出冗余设计：关键负载配置双路供电，一路来自电网，一路来自储能+光伏，备用电源启动时间 ≤ 2秒，通过模型3计算最优待机容量。

### 五、模型优缺点分析
优点：
1. 分层任务处理机制：模型将任务分为高、中、低优先级，并通过约束保证高优先级任务必须按时完成，中低优先级任务可在时间窗口内灵活调整。这种分层设计符合实际场景中任务的紧迫性差异。提高资源利用率，避免高优先级任务因资源不足而失败，同时通过灵活调度降低中低优先级任务的成本。

2. 混合能源成本与绿色奖励结合：目标函数同时优化传统能源成本、新能源成本，并通过奖励系数（$\beta $和$\gamma $）鼓励使用绿色能源和新能源供应高峰时段，在降低成本的同时促进低碳化，符合可持续发展目标。

3. 时间窗口灵活性：中低优先级任务允许在发布时刻后的24小时内任意时段完成，通过二元变量 实现离散决策。利用电价和新能源供应的时段差异，将任务分配到成本更低或新能源更充裕的时段。

缺点：
1. 计算复杂度高模型中大量使用二元变量（每个中低优先级任务需24个$\gamma $变量），当任务数量增加时，变量规模呈指数级增长。求解时间可能过长，尤其是实际场景中任务量庞大时，可能无法满足实时调度需求。

2. 新能源供应假设过于理想化：新能源供应量被假设为固定值，未考虑其随机性（如风电/光伏的间歇性）。实际调度中可能出现新能源供应不足导致模型不可行，或供应过剩导致资源浪费。

3. 奖励系数依赖经验设定：绿色能源奖励系数$\beta$和新能源供应奖励系数$\gamma $需人工设定，缺乏理论依据，可能导致奖励机制与成本优化目标冲突，例如过度追求绿色能源利用率反而抬升总成本。

4. 忽略传统能源的固定成本：模型中传统能源成本仅与用量线性相关，未考虑启动成本、最小负载等非线性因素，实际场景中传统发电机组的启停策略可能被忽略，导致成本估算偏差。
### 六、参考文献
[1]	孙俊,艾欣.促进风电消纳的VSC-MTDC互联系统鲁棒性安全约束机组组合[J/OL].现代电力,1-11[2025-04-22].https://doi.org/10.19725/j.cnki.1007-2322.2023.0287.
